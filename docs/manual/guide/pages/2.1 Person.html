<html><head><meta content='text/html; charset=utf-8' http-equiv='Content-type'></meta><title>2.1 Person</title><link title='Ref' charset='utf-8' rel='stylesheet' type='text/css' href='../css/main.css' media='screen'></link></head><body><body class='body'>
    Spring Security uses an <a target='blank' href='http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/core/Authentication.html'>Authentication</a> object to determine whether the current user has the right to perform a secured action, i.e. accessing a URL, manipulate a secured domain object, access a secured method, etc. This is created during login, and typically there's overlap between the need for the data that's required to populate the authentication (username, password, granted authorities, etc.) and the need to represent a user in the application in ways that aren't related to security. The mechanism for populating the authentication is completely pluggable in Spring Security - you only need to provide an implementation of <a target='blank' href='http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/core/userdetails/UserDetailsService.html'>UserDetailsService</a> and implement its one method, <code>loadUserByUsername()</code>.<p class='paragraph'></p>You can easily <a class='guide' href='../guide/single.html#7. Custom UserDetailsService'>plug in your own implementation</a> but by default the plugin uses a Grails 'person' domain class to manage this data. The class name and package can be named whatever you want, and so can the fields. By default the class name is <code>Person</code>, and <code>username</code>, <code>enabled</code>, <code>password</code> are the default names of the required properties. In addition it's expected that there is an <code>authorities</code> property to retrieve roles; this can either be a public field or a <code>getAuthorities()</code> method, and it can either be defined via a traditional GORM many-to-many or via a custom mapping (more HERE).<p class='paragraph'></p>Assuming you choose <code>com.mycompany.myapp</code> as your package, and <code>User</code> as your class name, you'll generate this class:<p class='paragraph'></p><div class='code'><pre><span class='java-keyword'>package</span> com.mycompany.myapp<p class='paragraph'></p>class User {<p class='paragraph'></p><span class='java-object'>String</span> username
   <span class='java-object'>String</span> password
   <span class='java-object'>boolean</span> enabled
   <span class='java-object'>boolean</span> accountExpired
   <span class='java-object'>boolean</span> accountLocked
   <span class='java-object'>boolean</span> passwordExpired<p class='paragraph'></p><span class='java-keyword'>static</span> constraints = {
      username blank: <span class='java-keyword'>false</span>, unique: <span class='java-keyword'>true</span>
      password blank: <span class='java-keyword'>false</span>
   }<p class='paragraph'></p><span class='java-keyword'>static</span> mapping = {
      password column: '`password`'
   }<p class='paragraph'></p>   Set&lt;Role&gt; getAuthorities() {
      UserRole.findAllByUser(<span class='java-keyword'>this</span>).collect { it.role } as Set
   }
}</pre></div><p class='paragraph'></p>and of course if you like you can add other properties, e.g. <code>email</code>, <code>firstName</code>, <code>lastName</code>, and convenience methods, etc.:<p class='paragraph'></p><div class='code'><pre><span class='java-keyword'>package</span> com.mycompany.myapp<p class='paragraph'></p>class User {<p class='paragraph'></p><span class='java-object'>String</span> username
   <span class='java-object'>String</span> password
   <span class='java-object'>boolean</span> enabled
   <span class='java-object'>String</span> email
   <span class='java-object'>String</span> firstName
   <span class='java-object'>String</span> lastName<p class='paragraph'></p><span class='java-keyword'>static</span> constraints = {
      username blank: <span class='java-keyword'>false</span>, unique: <span class='java-keyword'>true</span>
      password blank: <span class='java-keyword'>false</span>
   }<p class='paragraph'></p>   Set&lt;Role&gt; getAuthorities() {
      UserRole.findAllByUser(<span class='java-keyword'>this</span>).collect { it.role } as Set
   }<p class='paragraph'></p>   def someMethod {
      &#x2026;
   }
}</pre></div><p class='paragraph'></p>The <code>getAuthorities()</code> method is analagous to defining <code>static hasMany = [authorities: Authority]</code> in a traditional many-to-many mapping. This way <code>GormUserDetailsService</code> can call <code>user.authorities</code> during login to retrieve the roles without the overhead of a bidirectional many-to-many mapping.<p class='paragraph'></p>The class and property names are configurable using these configuration attributes:<p class='paragraph'></p><table cellpadding='0' class='wiki-table' border='0' cellspacing='0'><tr><th><strong class='bold'>Property</strong></th><th><strong class='bold'>Default Value</strong></th><th><strong class='bold'>Meaning</strong></th></tr><tr class='table-odd'><td>userLookup.userDomainClassName</td><td>'Person'</td><td>User class name</td></tr><tr class='table-even'><td>userLookup.usernamePropertyName</td><td>'username'</td><td>User class username field</td></tr><tr class='table-odd'><td>userLookup.passwordPropertyName</td><td>'password'</td><td>User class password field</td></tr><tr class='table-even'><td>userLookup.authoritiesPropertyName</td><td>'authorities'</td><td>User class role collection field</td></tr><tr class='table-odd'><td>userLookup.enabledPropertyName</td><td>'enabled'</td><td>User class enabled field</td></tr><tr class='table-even'><td>userLookup.accountExpiredPropertyName</td><td>'accountExpired'</td><td>User class account expired field</td></tr><tr class='table-odd'><td>userLookup.accountLockedPropertyName</td><td>'accountLocked'</td><td>User class account locked field</td></tr><tr class='table-even'><td>userLookup.passwordExpiredPropertyName</td><td>'passwordExpired'</td><td>User class password expired field</td></tr><tr class='table-odd'><td>userLookup.authorityJoinClassName</td><td>'PersonAuthority'</td><td>User/Role many-many join class name</td></tr></table><p class='paragraph'></p>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-16219500-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</body></html>